<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EssayMe - Orders</title>
  <link rel="icon" type="image/png" class="w-10 h-10 rounded-full" href="https://i.imgur.com/TAGG6CH_d.webp?maxwidth=760&fidelity=grand">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

</head>
<body class="bg-gray-50 font-sans">
  <!-- Navbar -->
  <header class="bg-white shadow-md">
    <div class="container mx-auto flex justify-between items-center py-4 px-6">
      <a href="#" class="text-2xl font-bold text-blue-600">Essay<span class="text-gray-800">Me</span></a>
      <nav>
      </nav>
    </div>
  </header>


<section id="place-order-section" class="py-16 bg-gradient-to-b from-indigo-100 via-white to-indigo-50">
  <div class="container mx-auto px-6 flex flex-wrap">
<!-- Steps Section -->
<div id="left-content" class="w-full lg:w-1/3 p-4 transition-all duration-500">
  
  <!-- Title: Steps to Completion -->
  <h3 class="text-2xl font-extrabold text-gray-900 lg:mb-6">üöÄ Steps to Success</h3>

  <!-- Large Screens: Structured, Bigger & Clearer Steps -->
  <div class="hidden lg:block">
    <ol class="space-y-6 pl-6 text-gray-700">
      <li class="flex items-start space-x-4">
        <span class="text-5xl text-indigo-600 font-bold">1Ô∏è‚É£</span>
        <div>
          <h4 class="text-xl font-bold text-gray-900">Upload Your Assignment</h4>
          <p class="text-md text-gray-600">Submit your task with details üì§</p>
        </div>
      </li>
      
      <li class="flex items-start space-x-4">
        <span class="text-5xl text-gray-600 font-bold">2Ô∏è‚É£</span>
        <div>
          <h4 class="text-xl font-bold text-gray-900">Assignment Review</h4>
          <p class="text-md text-gray-600">We analyze requirements before starting üîç</p>
        </div>
      </li>
      
      <li class="flex items-start space-x-4">
        <span class="text-5xl text-indigo-600 font-bold">3Ô∏è‚É£</span>
        <div>
          <h4 class="text-xl font-bold text-gray-900">Make a Small Deposit</h4>
          <p class="text-md text-gray-600">Secure your assignment with an initial payment üíµ</p>
        </div>
      </li>
      
      <li class="flex items-start space-x-4">
        <span class="text-5xl text-indigo-600 font-bold">4Ô∏è‚É£</span>
        <div>
          <h4 class="text-xl font-bold text-gray-900">Receive Your Work</h4>
          <p class="text-md text-gray-600">We deliver your completed assignment üìÑ</p>
        </div>
      </li>
      
      <li class="flex items-start space-x-4">
        <span class="text-5xl text-indigo-600 font-bold">5Ô∏è‚É£</span>
        <div>
          <h4 class="text-xl font-bold text-gray-900">Pay the Remaining Balance</h4>
          <p class="text-md text-gray-600">Complete your payment and download your work ‚úÖ</p>
        </div>
      </li>
    </ol>
  </div>

  <!-- Small & Medium Screens: Carousel -->
  <div class="lg:hidden">
    <div class="flex overflow-x-auto space-x-4 py-4">
      <!-- Step 1 -->
      <div class="min-w-[160px] max-w-[160px] p-5 bg-white border border-gray-300 rounded-lg shadow-md flex-shrink-0">
        <div class="text-center">
          <span class="block text-indigo-500 text-5xl mb-2">üì§</span>
          <h4 class="text-md font-semibold text-gray-800">Step 1</h4>
          <p class="text-xs text-gray-600 mt-1">Submit your task with details</p>
        </div>
      </div>

      <!-- Step 2 -->
      <div class="min-w-[160px] max-w-[160px] p-5 bg-white border border-gray-300 rounded-lg shadow-md flex-shrink-0">
        <div class="text-center">
          <span class="block text-gray-600 text-5xl mb-2">üîç</span>
          <h4 class="text-md font-semibold text-gray-800">Step 2</h4>
          <p class="text-xs text-gray-600 mt-1">We analyze requirements before starting</p>
        </div>
      </div>

      <!-- Step 3 -->
      <div class="min-w-[160px] max-w-[160px] p-5 bg-white border border-gray-300 rounded-lg shadow-md flex-shrink-0">
        <div class="text-center">
          <span class="block text-indigo-500 text-5xl mb-2">üíµ</span>
          <h4 class="text-md font-semibold text-gray-800">Step 3</h4>
          <p class="text-xs text-gray-600 mt-1">Make a small payment</p>
        </div>
      </div>

      <!-- Step 4 -->
      <div class="min-w-[160px] max-w-[160px] p-5 bg-white border border-gray-300 rounded-lg shadow-md flex-shrink-0">
        <div class="text-center">
          <span class="block text-indigo-500 text-5xl mb-2">üìÑ</span>
          <h4 class="text-md font-semibold text-gray-800">Step 4</h4>
          <p class="text-xs text-gray-600 mt-1">Get your completed work</p>
        </div>
      </div>

      <!-- Step 5 -->
      <div class="min-w-[160px] max-w-[160px] p-5 bg-white border border-gray-300 rounded-lg shadow-md flex-shrink-0">
        <div class="text-center">
          <span class="block text-indigo-500 text-5xl mb-2">‚úÖ</span>
          <h4 class="text-md font-semibold text-gray-800">Step 5</h4>
          <p class="text-xs text-gray-600 mt-1">Complete your balance</p>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Right Section: Dynamic Content -->
<div id="right-content" class="w-full lg:w-2/3 p-6 bg-white rounded-lg shadow-xl transition-all duration-500">
  <!-- Place Order Form -->
  <form id="place-order-form" onsubmit="handlePlaceOrder(event)">
    <h2 class="text-4xl font-extrabold text-gray-800 text-center mb-8">Place Your Order</h2>

    <!-- Order Type and Subject -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label for="subject" class="block text-sm font-semibold text-gray-800">Subject*</label>
        <select id="subject" class="mt-2 w-full rounded-lg border border-gray-300 bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
          <option value="">Select Subject</option>
          <option value="Mathematics">Mathematics</option>
          <option value="Physics">Physics</option>
          <option value="English Literature">English Literature</option>
          <option value="History">History</option>
        </select>
      </div>
      <div>
        <label for="order-type" class="block text-sm font-semibold text-gray-800">Order Type*</label>
        <select id="order-type" class="mt-2 w-full rounded-lg border border-gray-300 bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
          <option value="">Select</option>
          <option value="writing">Writing</option>
          <option value="rewriting">Rewriting</option>
          <option value="editing">Editing</option>
        </select>
      </div>
    </div>

    <!-- Assignment Description -->
    <div class="mt-6">
      <label for="description" class="block text-sm font-semibold text-gray-800">Assignment Description*</label>
      <textarea id="description" rows="4" class="mt-2 w-full rounded-lg border border-gray-300 bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500" placeholder="Describe your assignment in detail..." required></textarea>
    </div>

    <!-- Deadline and Page Count Section -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
      <div>
        <label for="deadline" class="block text-sm font-semibold text-gray-800">Deadline*</label>
        <input id="deadline" type="datetime-local" class="w-full rounded-lg border border-gray-300 bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required />
        <p class="text-xs text-gray-500 mt-1">Select a future date and time.</p>
      </div>
      <div>
        <label for="pages" class="block text-sm font-semibold text-gray-800">No. of Pages*</label>
        <div class="flex items-center space-x-4">
          <button type="button" id="decrease-pages" class="text-lg font-semibold text-indigo-500">-</button>
          <input id="pages" type="number" value="1" class="w-16 text-center rounded-lg border border-gray-300 bg-white shadow-sm" readonly />
          <button type="button" id="increase-pages" class="text-lg font-semibold text-indigo-500">+</button>
        </div>
        <p class="text-xs text-gray-500 mt-1">1 page = 250 words</p>
      </div>
    </div>

    <!-- File Upload -->
    <div class="mt-6">
      <label class="block text-sm font-semibold text-gray-800">Upload Files (Max 10 files)</label>
      <div class="flex items-center justify-center border-2 border-dashed border-pink-300 rounded-lg p-4 mt-2 relative">
        <input type="file" id="file-upload" class="hidden" multiple accept="image/*,application/pdf,.doc,.docx,.pptx,.xlsx" onchange="displayUploadedFiles()" />
        <label for="file-upload" class="text-gray-600 text-sm cursor-pointer">
          Drag & drop files here or <span class="text-indigo-600">browse</span>
        </label>
      </div>
      <ul id="file-list" class="mt-4 space-y-2 text-sm text-gray-600"></ul>
      <p id="file-warning" class="mt-2 text-sm text-red-500 hidden">You can only upload a maximum of 10 files.</p>
    </div>

    <!-- Email Address -->
    <div class="mt-6">
      <label for="email" class="block text-sm font-semibold text-gray-800">Email*</label>
      <input id="email" type="email" class="mt-2 w-full rounded-lg border border-gray-300 bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your email" required />
      <p id="email-status" class="mt-2 text-sm"></p>
    </div>

    <!-- Terms and Conditions -->
    <div class="flex items-start mt-6">
      <input id="terms" type="checkbox" class="h-5 w-5 rounded text-indigo-600 border-gray-300 focus:ring-indigo-500" required />
      <label for="terms" class="ml-2 text-sm text-gray-600">I accept the <a href="#" class="text-indigo-600 underline">terms & conditions</a>.</label>
    </div>

    <!-- Submit Button -->
    <div class="text-center mt-8">
      <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg font-semibold shadow-lg">
        Submit
      </button>
    </div>
  </form>
  <script>    
    // Page count increment and decrement functionality
    const pageInput = document.getElementById('pages');
    const decreaseButton = document.getElementById('decrease-pages');
    const increaseButton = document.getElementById('increase-pages');
    
    decreaseButton.addEventListener('click', () => {
      let currentValue = parseInt(pageInput.value);
      if (currentValue > 1) {
        pageInput.value = currentValue - 1;
      }
    });
    
    increaseButton.addEventListener('click', () => {
      let currentValue = parseInt(pageInput.value);
      pageInput.value = currentValue + 1;
    });
    
    // Prevent past dates and times in the deadline input
    const currentDatetime = new Date();
    const year = currentDatetime.getFullYear();
    const month = String(currentDatetime.getMonth() + 1).padStart(2, '0');
    const day = String(currentDatetime.getDate()).padStart(2, '0');
    const hours = String(currentDatetime.getHours()).padStart(2, '0');
    const minutes = String(currentDatetime.getMinutes()).padStart(2, '0');
    const currentDatetimeString = `${year}-${month}-${day}T${hours}:${minutes}`;
    document.getElementById('deadline').setAttribute('min', currentDatetimeString);
    
  // Function to display the uploaded files
  function displayUploadedFiles() {
    const fileInput = document.getElementById('file-upload');
    const fileList = document.getElementById('file-list');
    const fileWarning = document.getElementById('file-warning');
    const files = fileInput.files;

    // Show the warning if more than 10 files are uploaded
    if (files.length > 10) {
      fileWarning.classList.remove('hidden');
      return;
    } else {
      fileWarning.classList.add('hidden');
    }

    // Append new files to the list
    for (let i = 0; i < files.length; i++) {
      const file = files[i];

      // Check if the file is already in the list
      const existingFiles = Array.from(fileList.querySelectorAll('li')).map(item => item.textContent.trim());
      if (existingFiles.includes(file.name)) {
        continue; // Skip if file already exists
      }

      const listItem = document.createElement('li');
      listItem.classList.add('flex', 'justify-between', 'items-center');
      
      const fileName = document.createElement('span');
      fileName.textContent = file.name;

      const removeButton = document.createElement('button');
      removeButton.textContent = 'Remove';
      removeButton.classList.add('text-red-500', 'text-xs', 'ml-2', 'hover:underline');
      removeButton.onclick = () => removeFile(file);

      listItem.appendChild(fileName);
      listItem.appendChild(removeButton);
      fileList.appendChild(listItem);
    }
  }

  // Function to remove a file from the input and list
  function removeFile(fileToRemove) {
    const fileInput = document.getElementById('file-upload');
    const fileList = document.getElementById('file-list');
    const files = Array.from(fileInput.files);
    
    // Remove the selected file from the file input
    const updatedFiles = files.filter(file => file.name !== fileToRemove.name);
    const dataTransfer = new DataTransfer();
    updatedFiles.forEach(file => dataTransfer.items.add(file));
    fileInput.files = dataTransfer.files;

    // Remove the file from the list UI
    const listItems = fileList.querySelectorAll('li');
    listItems.forEach(item => {
      if (item.textContent.includes(fileToRemove.name)) {
        item.remove();
      }
    });
  }

  // Optional: Handle drag and drop to add files to the input field
  const dropArea = document.querySelector('.border-dashed');
  dropArea.addEventListener('dragover', function(e) {
    e.preventDefault();
    dropArea.classList.add('border-indigo-400');
  });

  dropArea.addEventListener('dragleave', function(e) {
    e.preventDefault();
    dropArea.classList.remove('border-indigo-400');
  });

  dropArea.addEventListener('drop', function(e) {
    e.preventDefault();
    dropArea.classList.remove('border-indigo-400');

    // Simulate file input change by assigning dropped files to the input element
    const files = e.dataTransfer.files;
    const fileInput = document.getElementById('file-upload');

    // Append the dropped files to the existing files
    const dataTransfer = new DataTransfer();
    for (let file of fileInput.files) {
      dataTransfer.items.add(file);
    }
    for (let file of files) {
      dataTransfer.items.add(file);
    }
    fileInput.files = dataTransfer.files;

    displayUploadedFiles();
  });
  
    // Handle Order Placement
    async function handlePlaceOrder(event) {
  event.preventDefault();

  const email = document.getElementById("email").value.trim();
  const description = document.getElementById("description").value.trim();
  const subject = document.getElementById("subject").value;
  const orderType = document.getElementById("order-type").value;
  const deadline = document.getElementById("deadline").value;
  const pages = parseInt(document.getElementById("pages").value);

  if (!email || !description || !subject || !orderType || !deadline || !pages) {
    alert("Please fill in all required fields.");
    return;
  }

  try {
    // Submit the order
    const response = await fetch("http://localhost:3002/api/submit-order", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, subject, orderType, description, deadline, pages }),
    });

    if (!response.ok) throw new Error("Failed to place order.");

    const data = await response.json();

    // Check if user is logged in
    const userId = localStorage.getItem("userId");
    if (!userId) {
      // Show validation if not logged in
      document.getElementById("place-order-form").classList.add("hidden");
      document.getElementById("validation-section").classList.remove("hidden");
      document.getElementById("validation-email").value = email;
    } else {
      // Redirect to dashboard if logged in
      redirectToDashboard();
    }
  } catch (error) {
    console.error("Order Submission Error:", error.message);
    alert("Error while submitting the order. Please try again.");
  }
}
</script>
</section>
    
</body>
</html>